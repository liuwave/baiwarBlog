<include file="Public:header" />
<body>
<include file="Public:nav" />

<div class="container">
  <!--内容开始-->
  <div class="page-header">
    <h3>新建/编辑产品</h3>
  </div>
  <form role="form" id="productForm" method="post" action="{:U('add')}" enctype="multipart/form-data">
    <input type="text" id="pid" name="pid" value="{$product.pid}" hidden="hidden">
    <input class="hidden" name="img" id="img" type="text" value="{$product.img}">
    <input class="hidden" name="thumb" id="thumb" type="text" value="{$product.thumb}">

    <input type="text" name="name" id="name" value="{$product.name}" class="form-control miniinput5" placeholder="名称" >
    <input type="text" name="keywords" id="keywords" value="{$product.keywords}" class="form-control miniinput5" placeholder="关键词" >
    <input type="text" name="spec" id="spec" value="{$product.spec}" class="form-control miniinput5" placeholder="包装规格" >

    <div class="thumbnail upload-button">
      <button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <img id="upoadImgShow" src="{$product.thumb}">
    </div>
    <input type="button" id="uploadImg" class="upload-button " value="上传图片">


    <textarea class="form-control miniinput3" rows="20" id="editor_id" name="description">{$product.description}</textarea>

    <button type="submit" class="btn btn-info minibtn">{$Think.lang._release_}</button>

  </form>


</div>
<include file="Public:Copy" />
<script charset="utf-8" src="[!Public]editor/kindeditor.js"></script>
<script charset="utf-8" src="[!Public]editor/lang/zh-cn.js"></script>
<script>
  var editor;
  KindEditor.ready(function(K) {
    editor = K.create('textarea[name="description"]', {
      uploadJson: '[!Public]editor/php/upload_json.php',
      fileManagerJson: '[!Public]editor/php/file_manager_json.php',
      themeType: 'simple',
      langType:'{$Think.config.DEFAULT_LANG}',
      allowFileManager: true,
      allowPreviewEmoticons: true,
      allowImageUpload: true,
      afterBlur: function() {
        this.sync();
      },
      items: ['source', '|', 'fullscreen', 'undo', 'redo', 'print', 'cut', 'copy', 'paste', 'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright', 'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript', 'superscript', 'title', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline', 'strikethrough', 'removeformat', '|', 'image', 'flash', 'media', 'advtable', 'emoticons', 'link', 'unlink', '|', 'baidumap', 'code', 'about'],
    });

    var uploadbutton = K.uploadbutton({
      button : K('#uploadImg')[0],
      fieldName : 'imgFile',
      url : '[!Public]editor/php/upload_json.php',
      afterUpload : function(data) {
        if (data.error === 0) {
          //alert(data.url);
//          console.log(data);
          $("#upoadImgShow").attr("src",data.url);
          $("#img").val(data.url);
          $("#thumb").val(data.url);


        } else {
          //alert(data.message);
        }
      }
    });
    uploadbutton.fileBox.change(function(e) {
      uploadbutton.submit();
    });


  });

/*
  $(".container").on("submit","#productForm",function(e){
    e.preventDefault();
    console.log($("#productForm").serialize());
    $.post("{:U('/Admin/Product/add')}",$("#productForm").serialize(),function(data){
      if(data.status>0){

      }
    });
  });*/
</script>


</body>

</html>